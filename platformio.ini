; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[env]
platform = nordicnrf52
board = nano33ble
framework = arduino
build_src_filter = +<${PIOENV}.cpp>

monitor_filters = send_on_enter
monitor_speed = 115200
monitor_echo = yes
monitor_eol = LF

lib_deps =
    ; General Libraries
    FireTimer@1.0.5

    ; Sensor Libraries  
    https://github.com/arduino-libraries/Arduino_LPS22HB
    https://github.com/sparkfun/SparkFun_BMI270_Arduino_Library
    Arduino_LSM6DSOX@1.1.2

    ; TVC Control Libraries
    tkjelectronics/Kalman Filter Library@1.0.2
    arduino-libraries/Servo@1.2.2

    ; SD Card Libraries
    SPI
    Wire

    greiman/SdFat@2.2.3
    SDConfig@1.1.0

# Interactive tests
[env:interactive-test-ble]  ; Interactive test
lib_deps=
    ${env.lib_deps}
    ArduinoBLE@1.3.7
    HardwareBLESerial@1.0.0
build_flags = -D USE_BLE=0

[env:interactive-test-noble]
build_src_filter = +<interactive-test-ble.cpp>
build_flags = -D USE_BLE=0

[env:interactive-test-esp32]
platform = espressif32
board = arduino_nano_esp32
lib_deps = 
    ${env.lib_deps}
    ESP32Servo@1.0.0

# Flight routines
[env:main]                  ; Main flight code
lib_deps=      
    ${env:interactive-test-ble.lib_deps}

[env:main-tvc]              ; Main flight code (TVC only)  
lib_deps=
    ${env:main.lib_deps}

; Utility scripts
[env:calibrateBMI]
[env:benchSdCard]
[env:formatSdCard]

; Component est scripts
[env:alt-test]              ; Altitude test
[env:compl-test]            ; Complementary filter test
[env:gyro-test]             ; Pure gyro test
[env:kalman-test]           ; Kalman filter test
[env:pyro-test]             ; Pyro channel test
[env:quat-angle]            ; Quaternion test
[env:sd-test]               ; SD card test
[env:servo-test]            ; Servo test
[env:states-test]           ; States test
[env:tvc-test]              ; TVC test